diff -u -r1.307 include/Scintilla.iface
--- include/Scintilla.iface	23 Apr 2007 02:26:05 -0000	1.307
+++ include/Scintilla.iface	23 May 2007 20:53:59 -0000
@@ -1825,6 +1825,24 @@
 # Retrieve the number of bits the current lexer needs for styling.
 get int GetStyleBitsNeeded=4011(,)
 
+### ACTIVESTATE Functions 5000+ ####
+
+# Set the drag caret position
+set void SetDragPosition=5002(position pos,)
+
+# Returns the position of the caret.
+get position GetDragPosition=5003(,)
+
+# Returns the position of the character.
+fun position PositionAtChar=5004(position start, int charoffset)
+
+# Returns the position of the column.
+fun position PositionAtColumn=5005(int line, int column)
+
+# Returns the position of the caret.
+fun position CharPosAtPosition=5006(position pos,)
+
+
 # Notifications
 # Type of modification and the action which caused the modification.
 # These are defined as a bit mask to make it easy to specify which notifications are wanted.
@@ -1972,6 +1993,9 @@
 val SCLEX_GAP=81
 val SCLEX_PLM=82
 val SCLEX_PROGRESS=83
+val SCLEX_XSLT=84
+# User-defined languages
+val SCLEX_UDL=85
 
 # When a lexer specifies its language as SCLEX_AUTOMATIC it receives a
 # value assigned in sequence from SCLEX_AUTOMATIC+1.
@@ -1994,6 +2018,11 @@
 val SCE_P_STRINGEOL=13
 val SCE_P_WORD2=14
 val SCE_P_DECORATOR=15
+# python terminal support
+val SCE_P_STDIN = 16
+val SCE_P_STDOUT = 17
+val SCE_P_STDERR = 18
+val SCE_P_UPPER_BOUND=19
 # Lexical states for SCLEX_CPP
 lex Cpp=SCLEX_CPP SCE_C_
 lex Pascal=SCLEX_PASCAL SCE_C_
@@ -2018,6 +2047,9 @@
 val SCE_C_COMMENTDOCKEYWORD=17
 val SCE_C_COMMENTDOCKEYWORDERROR=18
 val SCE_C_GLOBALCLASS=19
+val SCE_C_STDIN=20
+val SCE_C_STDOUT=21
+val SCE_C_STDERR=22
 # Lexical states for SCLEX_D
 lex D=SCLEX_D SCE_D_
 val SCE_D_DEFAULT=0
@@ -2042,26 +2074,22 @@
 lex TCL=SCLEX_TCL SCE_TCL_
 val SCE_TCL_DEFAULT=0
 val SCE_TCL_COMMENT=1
-val SCE_TCL_COMMENTLINE=2
-val SCE_TCL_NUMBER=3
-val SCE_TCL_WORD_IN_QUOTE=4
-val SCE_TCL_IN_QUOTE=5
-val SCE_TCL_OPERATOR=6
-val SCE_TCL_IDENTIFIER=7
-val SCE_TCL_SUBSTITUTION=8
-val SCE_TCL_SUB_BRACE=9
-val SCE_TCL_MODIFIER=10
-val SCE_TCL_EXPAND=11
-val SCE_TCL_WORD=12
-val SCE_TCL_WORD2=13
-val SCE_TCL_WORD3=14
-val SCE_TCL_WORD4=15
-val SCE_TCL_WORD5=16
-val SCE_TCL_WORD6=17
-val SCE_TCL_WORD7=18
-val SCE_TCL_WORD8=19
-val SCE_TCL_COMMENT_BOX=20
-val SCE_TCL_BLOCK_COMMENT=21
+val SCE_TCL_VARIABLE=2
+val SCE_TCL_ARRAY=3
+val SCE_TCL_NUMBER=4
+val SCE_TCL_WORD=5
+val SCE_TCL_STRING=6
+val SCE_TCL_CHARACTER=7
+val SCE_TCL_LITERAL=8
+val SCE_TCL_IDENTIFIER=9
+# SCE_TCL_OPERATOR must == SCE_PL_OPERATOR in order for brace matching
+# to work (until language services better abstract this)
+val SCE_TCL_OPERATOR=10
+val SCE_TCL_EOL=11
+val SCE_TCL_STDIN=12
+val SCE_TCL_STDOUT=13
+val SCE_TCL_STDERR=14
+val SCE_TCL_UPPER_BOUND=15
 # Lexical states for SCLEX_HTML, SCLEX_XML
 lex HTML=SCLEX_HTML SCE_H
 lex XML=SCLEX_XML SCE_H
@@ -2224,6 +2252,15 @@
 val SCE_PL_STRING_QR=29
 val SCE_PL_STRING_QW=30
 val SCE_PL_POD_VERB=31
+### ACTIVESTATE PERL LEXER ADDITIONS
+val SCE_PL_SUB=40
+val SCE_PL_SUB_ARGS=41
+val SCE_PL_UNKNOWN_FIELD=42
+val SCE_PL_STDIN=43
+val SCE_PL_STDOUT=44
+val SCE_PL_STDERR=45
+val SCE_PL_FORMAT=46
+val SCE_PL_UPPER_BOUND=47
 # Lexical states for SCLEX_RUBY
 lex Ruby=SCLEX_RUBY SCE_RB_
 val SCE_RB_DEFAULT=0
@@ -3189,6 +3226,136 @@
 val SCE_4GL_COMMENT5_=30
 val SCE_4GL_COMMENT6_=31
 
+# Lexical states for the SCLEX_XML (XML files)
+val SCE_XML_DEFAULT=0
+val SCE_XML_PROLOG=0
+val SCE_XML_START_TAG_OPEN=1
+val SCE_XML_START_TAG_NAME=2 
+val SCE_XML_START_TAG_CLOSE=3
+val SCE_XML_START_TAG_EMPTY_CLOSE=4
+val SCE_XML_START_TAG_ATTR_NAME=5  
+val SCE_XML_START_TAG_ATTR_EQUALS=6
+val SCE_XML_START_TAG_ATTR_QUOT_OPEN=7
+val SCE_XML_START_TAG_ATTR_QUOT_CONTENT=8
+val SCE_XML_START_TAG_ATTR_QUOT_CLOSE=9
+val SCE_XML_START_TAG_ATTR_APOS_OPEN=10
+val SCE_XML_START_TAG_ATTR_APOS_CONTENT=11
+val SCE_XML_START_TAG_ATTR_APOS_CLOSE=12
+val SCE_XML_END_TAG_OPEN=13
+val SCE_XML_END_TAG_NAME=14
+val SCE_XML_END_TAG_CLOSE=15
+val SCE_XML_START_TAG_ATTR_NUMBER=16
+val SCE_XML_ENTITY_REF=17
+val SCE_XML_CHAR_REF=18
+val SCE_XML_DATA_NEWLINE=19
+val SCE_XML_DATA_CHARS=20
+val SCE_XML_CDATA_SECT_OPEN=21
+val SCE_XML_CDATA_SECT_CONTENT=22
+val SCE_XML_CDATA_SECT_CLOSE=23
+val SCE_XML_COMMENT_OPEN=24
+val SCE_XML_COMMENT_CONTENT=25
+val SCE_XML_COMMENT_CLOSE=26
+val SCE_XML_PI_OPEN=27
+val SCE_XML_PI_CONTENT=28
+val SCE_XML_PI_CLOSE=29
+val SCE_XML_XML_DECL_OPEN=30
+val SCE_XML_XML_DECL_CONTENT=31
+# Scintilla itself uses 32-39 internally so skip those.
+val SCE_XML_XML_DECL_CLOSE=40
+val SCE_XML_BOM=41
+val SCE_XPATH_TAG_NAME=42
+val SCE_XPATH_ATTR_NAME=43
+val SCE_XPATH_OPEN=44
+val SCE_XPATH_CONTENT_QUOT=45
+val SCE_XPATH_CONTENT_APOS=46
+val SCE_XPATH_CLOSE=47
+val SCE_XML_START_TAG_WHITE_SPACE=48
+val SCE_XML_START_TAG_ATTR_UNQUOTED=49
+val SCE_XML_END_TAG_WHITE_SPACE=50
+val SCE_XML_DECLARATION_OPEN=51
+val SCE_XML_DECLARATION_TYPE=52
+val SCE_XML_DECLN_WHITE_SPACE=53
+val SCE_XML_DECLN_NAME=54
+val SCE_XML_DECLN_CLOSE=55
+val SCE_XML_DECLN_QUOT_CONTENT=56
+val SCE_XML_DECLN_APOS_CONTENT=57
+val SCE_XML_DECLN_DATA_CHARS=58
+val SCE_XML_UPPER_BOUND=59
+
+
+# Lexical states for SCLEX_UDL ("UDL" == user-defined languages)
+# These define the states each UDL needs to define.
+
+# The lexer for these uses a parallel set of states to determine what
+# it's looking at, so some of these states can fold to common colors.
+
+# Specifically:
+# *_DEFAULT => 0
+# *_COMMENT => 15
+# *_COMMENTBLOCK => 15
+# *_NUMBER => 20
+# *_STRING => 21
+# *_OPERATOR => 24
+
+lex UDL=SCLEX_UDL SCE_UDL_
+val SCE_UDL_M_DEFAULT=0
+val SCE_UDL_M_STAGO=1
+val SCE_UDL_M_TAGNAME=2
+val SCE_UDL_M_TAGSPACE=3
+val SCE_UDL_M_ATTRNAME=4
+val SCE_UDL_M_OPERATOR=5
+val SCE_UDL_M_STAGC=6
+val SCE_UDL_M_EMP_TAGC=7
+val SCE_UDL_M_STRING=8
+val SCE_UDL_M_ETAGO=9
+val SCE_UDL_M_ETAGC=10
+val SCE_UDL_M_ENTITY=11
+val SCE_UDL_M_PI=12
+val SCE_UDL_M_CDATA=13
+val SCE_UDL_M_COMMENT=14
+# UDL: style (reduced CSS) language
+# Don't bother reserving slots, just renumber on (hopefully infrequent) changes
+val SCE_UDL_CSS_DEFAULT=15
+val SCE_UDL_CSS_COMMENT=16
+val SCE_UDL_CSS_NUMBER=17
+val SCE_UDL_CSS_STRING=18
+val SCE_UDL_CSS_WORD=19
+val SCE_UDL_CSS_IDENTIFIER=20
+val SCE_UDL_CSS_OPERATOR=21
+# UDL: client-side language
+val SCE_UDL_CSL_DEFAULT=22
+val SCE_UDL_CSL_COMMENT=23
+val SCE_UDL_CSL_COMMENTBLOCK=24
+val SCE_UDL_CSL_NUMBER=25
+val SCE_UDL_CSL_STRING=26
+val SCE_UDL_CSL_WORD=27
+val SCE_UDL_CSL_IDENTIFIER=28
+val SCE_UDL_CSL_OPERATOR=29
+val SCE_UDL_CSL_REGEX=30
+# UDL: server-side
+val SCE_UDL_SSL_DEFAULT=31
+val SCE_UDL_SSL_COMMENT=40
+val SCE_UDL_SSL_COMMENTBLOCK=41
+val SCE_UDL_SSL_NUMBER=42
+val SCE_UDL_SSL_STRING=43
+val SCE_UDL_SSL_WORD=44
+val SCE_UDL_SSL_IDENTIFIER=45
+val SCE_UDL_SSL_OPERATOR=46
+val SCE_UDL_SSL_REGEX=47
+val SCE_UDL_SSL_VARIABLE=48
+# Room for 7 more terms.
+# Specialize template mini-languages (e.g., Perl Template Toolkit, PHP Smarty)
+val SCE_UDL_TPL_DEFAULT=49
+val SCE_UDL_TPL_COMMENT=50
+val SCE_UDL_TPL_COMMENTBLOCK=51
+val SCE_UDL_TPL_NUMBER=52
+val SCE_UDL_TPL_STRING=53
+val SCE_UDL_TPL_WORD=54
+val SCE_UDL_TPL_IDENTIFIER=55
+val SCE_UDL_TPL_OPERATOR=56
+val SCE_UDL_TPL_VARIABLE=57
+val SCE_UDL_UPPER_BOUND=57
+
 # Events
 
 evt void StyleNeeded=2000(int position)
--- include/Scintilla.h   Thu Sep 27 11:10:30 2007
+++ include/Scintilla.h Mon Oct 29 16:38:27 2007
@@ -673,6 +673,11 @@
 #define SCI_GETPROPERTYEXPANDED 4009
 #define SCI_GETPROPERTYINT 4010
 #define SCI_GETSTYLEBITSNEEDED 4011
+#define SCI_SETDRAGPOSITION 5002
+#define SCI_GETDRAGPOSITION 5003
+#define SCI_POSITIONATCHAR 5004
+#define SCI_POSITIONATCOLUMN 5005
+#define SCI_CHARPOSATPOSITION 5006
 #define SC_MOD_INSERTTEXT 0x1
 #define SC_MOD_DELETETEXT 0x2
 #define SC_MOD_CHANGESTYLE 0x4